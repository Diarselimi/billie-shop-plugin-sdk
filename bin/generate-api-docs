#!/usr/bin/env bash

CURR_DATE=$(date +"%Y.%m")
SPEC_VERSION="v${CURR_DATE}"
SPEC_DIR="docs/openapi"
SPEC_TITLE="Billie - PaD API Documentation"
SPEC_GROUP=${1:-"full"}
SPEC_FILE="${SPEC_DIR}/paella-openapi-${SPEC_GROUP}.yaml"

echo "   Generating OpenAPI 3.0 YAML specification for group '${SPEC_GROUP}'."

mkdir -p ${SPEC_DIR}
rm -f ${SPEC_FILE}

bin/console paella:openapi:generate "${SPEC_VERSION}" --groups="${SPEC_GROUP}" \
  --output-file="${SPEC_FILE}" --title="${SPEC_TITLE}" "${@:2}"

echo "   Specification file successfully generated under ${SPEC_FILE}."
